# Вакансии и база данных

Этот проект взаимодействует с API HeadHunter, получает информацию о вакансиях, сохраняет её в базе данных PostgreSQL и предоставляет возможность выполнения различных запросов к базе данных для получения статистики по вакансиям.

## Структура проекта

- **src**: содержит все исходные файлы проекта
  - **base_api.py**: базовый класс для работы с API
  - **base_db.py**: базовый класс для работы с базой данных
  - **db_manager.py**: класс для работы с базой данных SQL
  - **hh_api.py**: класс для работы с API HeadHunter
  - **logger.py**: настройка логирования
  - **sql_database.py**: класс для работы с базой данных PostgreSQL
  - **config.py**: настройка конфигурации для подключения к базе данных

## Описание классов

### HeadHunterAPI
Класс для работы с API HeadHunter. Загружает вакансии, проверяет их на обязательные поля (зарплата и адрес) и выполняет валидацию данных.

#### Методы:
- `__init__(self)`: Инициализация API, загрузка вакансий и их валидация.
- `vacancies`: Геттер для получения списка вакансий.
- `_load_vacancies(self)`: Загрузка вакансий с API HeadHunter.
- `_validate_vacancy(self)`: Валидирует вакансии, удаляя те, у которых отсутствуют обязательные данные.

### DataBaseSQL
Класс для работы с PostgreSQL базой данных. Создаёт базу данных, таблицы и выполняет операции вставки данных о вакансиях.

#### Методы:
- `__init__(self, database_name: str, **params: dict)`: Инициализация подключения к базе данных.
- `create_database(self)`: Создаёт базу данных, если её нет.
- `create_tables(self)`: Создаёт таблицы в базе данных.
- `insert_data_to_db(self, vacancies: list)`: Вставляет данные о вакансиях в таблицы.

### DBManager
Класс для работы с базой данных для извлечения информации о вакансиях и компаниях.

#### Методы:
- `connect(self)`: Устанавливает соединение с базой данных.
- `get_companies_and_vacancies_count(self)`: Получает количество вакансий для каждой компании.
- `get_all_vacancies(self)`: Получает все вакансии с информацией о работодателе, названии вакансии, зарплате и URL вакансии.
- `get_avg_salary(self)`: Получает среднюю зарплату по вакансиям.
- `get_vacancies_with_higher_salary(self)`: Получает вакансии с зарплатой выше средней.
- `get_vacancies_with_keyword(self, keyword: str)`: Получает вакансии, содержащие указанное ключевое слово.

### config
Функция для чтения конфигурационного файла и получения параметров подключения к базе данных.

### setup_logger
Функция для настройки логирования в проекте.

## Установка

Для установки зависимостей выполните следующую команду:

```bash
pip install -r requirements.txt
```
```bash
poetry install
```

## Настройка
1.	Создайте файл конфигурации database.ini в корне проекта. 
Пример содержимого файла:
```ini
[postgresql]
host=localhost
user=your_user
password=your_password
port=5432
```
2.	Убедитесь, что у вас установлены все зависимости для работы с PostgreSQL (например, psycopg2).

## Запуск проекта
Для запуска проекта просто выполните команду:
```bash
python main.py
```
## Логирование
Проект использует логирование для отслеживания действий с API и базы данных. Логи записываются в директорию logs, которая будет создана автоматически.

## Лицензия

Этот проект лицензируется под MIT License.
Этот файл README.md описывает основную структуру проекта, классы и их методы, настройку и запуск проекта.